<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>æ–°å¹´çƒŸèŠ±</title>
    <link rel="stylesheet" href="çƒŸèŠ±æ ·å¼.css">
    <style>
        /* æ·»åŠ ä»¥ä¸‹æ ·å¼æ¥é˜²æ­¢é¡µé¢æŠ–åŠ¨ */
        html {
            overflow-y: scroll;
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none;  /* IE and Edge */
        }

        html::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
        }

        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
            overflow-x: hidden;
        }
    </style>
</head>
<body>
    <!-- é¡¶æ  -->
    <div class="top-bar">
        <button class="menu-button" onclick="toggleSidebar()">â˜°</button>
        <div class="top-bar-title">æ–°å¹´çƒŸèŠ±</div>
    </div>

    <!-- ä¾§è¾¹æ  -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-title">æ–°å¹´çƒŸèŠ±</div>
            <div class="sidebar-subtitle">è®©æˆ‘ä»¬ä¸€èµ·è¿æ¥æ–°å¹´</div>
        </div>
        <div class="sidebar-menu">
            <div class="menu-item" onclick="showWishDialog()">
                <i>âœ¨</i>
                <span>å‘é€æ„¿æœ›</span>
            </div>
            <div class="menu-item" onclick="toggleMusic()">
                <i>ğŸµ</i>
                <span>èƒŒæ™¯éŸ³ä¹</span>
            </div>
            <div class="menu-divider"></div>
            <div class="menu-item" onclick="showSettings()">
                <i>âš™ï¸</i>
                <span>æ•ˆæœè®¾ç½®</span>
            </div>
            <div class="menu-item" onclick="showAbout()">
                <i>â„¹ï¸</i>
                <span>å…³äº</span>
            </div>
        </div>
    </div>

    <!-- å°†åŸæœ‰å†…å®¹åŒ…è£…åœ¨main-contentä¸­ -->
    <div class="main-content">
        <!-- æ·»åŠ æ¨¡ç³ŠèƒŒæ™¯é®ç½© -->
        <div class="blur-overlay" id="blurOverlay"></div>
        <!-- ä¿®æ”¹ wish-container çš„ä½ç½®ï¼Œç¡®ä¿å§‹ç»ˆå±…ä¸­ -->
        <div class="centered-content">
            <div class="wish-container" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 100;">
                <input type="text" class="wish-input" id="wish" placeholder="å†™ä¸‹ä½ çš„æ–°å¹´æ„¿æœ›">
                <button class="launch-btn" onclick="launchFireworks()">ç‚¹ç‡ƒçƒŸèŠ±</button>
            </div>
            <div id="wishDisplay" class="wish-display" style="font-size: 40px; font-family: HarmonyOS Sans SC, sans-serif;"></div>
        </div>

        <!-- æ–°å¢æ§åˆ¶æŒ‰é’®å®¹å™¨ -->
        <div class="controls-container">
            <button class="fab-button" onclick="showWishDialog()">âœ¨</button>
            <button class="fab-button" onclick="toggleMusic()">ğŸµ</button>
            <button class="fab-button" onclick="showSettings()">âš™ï¸</button>
        </div>

        <!-- æ„¿æœ›å¯¹è¯æ¡† -->
        <div class="dialog" id="wishDialog">
            <h2>å†™ä¸‹ä½ çš„æ–°å¹´æ„¿æœ›</h2>
            <div class="md-input">
                <input type="text" id="wishInput" required>
                <label>ä½ çš„æ„¿æœ›</label>
            </div>
            <button class="md-button" onclick="submitWish()">å‘é€æ„¿æœ›</button>
        </div>

        <!-- è®¾ç½®å¯¹è¯æ¡† -->
        <div class="dialog" id="settingsDialog">
            <h2>è®¾ç½®</h2>
            <div class="md-input">
                <input type="range" id="fireworkSpeed" min="1" max="10" value="5">
                <label>çƒŸèŠ±é€Ÿåº¦</label>
            </div>
            <div class="md-input">
                <input type="range" id="fireworkDensity" min="1" max="10" value="5">
                <label>çƒŸèŠ±å¯†åº¦</label>
            </div>
            <button class="md-button" onclick="saveSettings()">ä¿å­˜è®¾ç½®</button>
        </div>

        <div class="overlay" id="overlay"></div>
    </div>

    <script>
        // å¸¸é‡é…ç½®
        const CONFIG = {
            // é¢œè‰²é…ç½®
            colors: {
                firework: ['#ff0', '#f0f', '#0ff', '#ff4444', '#44ff44', '#ff8800', '#00ff88', '#8800ff', '#ffcc00', '#cc00ff'],
                lantern: {
                    base: ['#ff4d4d', '#ff6b6b'],
                    glow: ['255, 77, 77', '255, 166, 0'],
                    flame: ['255, 235, 59', '255, 215, 0', '255, 165, 0', '255, 140, 0']
                }
            },
            
            // çƒŸèŠ±é…ç½®
            firework: {
                types: ['circle', 'heart', 'spiral', 'double', 'burst'],
                particleCounts: {
                    heart: 40,
                    spiral: 50,
                    burst: 30,
                    circle: 30,
                    double: 60
                },
                size: {
                    min: 8,
                    max: 15
                },
                duration: {
                    rise: 20,
                    explosion: 1500,
                    burst: 1200
                },
                spread: {
                    heart: 10,
                    spiral: 4,
                    burst: 40,
                    circle: 150
                }
            },

            // æ–‡å­—é…ç½®
            text: {
                wishes: [
                    'æ–°å¹´å¿«ä¹', 'æ­å–œå‘è´¢', 'å¿ƒæƒ³äº‹æˆ', 'ä¸‡äº‹å¦‚æ„',
                    'å‰ç¥¥å¦‚æ„', 'å¤§å‰å¤§åˆ©', 'è´¢æºå¹¿è¿›', 'å¹´å¹´æœ‰ä½™',
                    'ç¦æ˜Ÿé«˜ç…§', 'é¾™é©¬ç²¾ç¥', 'å‰ç¨‹ä¼¼é”¦', 'æ­¥æ­¥é«˜å‡',
                    'äº‹ä¸šæœ‰æˆ', 'å¹³å®‰å–œä¹', 'å¹¸ç¦å®‰åº·'
                ],
                lantern: ['ç¦', 'æ˜¥', 'å–œ', 'å®‰', 'åº·', 'æ—º', 'è´¢', 'ä¹', 'å‰', 'ç¥¥'],
                fontSize: {
                    min: 40,
                    max: 80
                },
                showWishProbability: 0.3
            },

            // åŠ¨ç”»é…ç½®
            animation: {
                lanternInterval: 2000,
                fireworkInterval: 800,
                textDuration: 800
            },

            // äº‘æœµé…ç½®
            cloud: {
                count: 3,
                sizes: {
                    min: 60,
                    max: 120
                },
                heights: {
                    min: 20,
                    max: 60
                },
                speeds: {
                    min: 20,
                    max: 40
                },
                interval: 10000 // æ¯10ç§’ç”Ÿæˆä¸€æœµæ–°äº‘
            }
        };

        // å·¥å…·å‡½æ•°
        const utils = {
            random: (min, max) => Math.random() * (max - min) + min,
            randomInt: (min, max) => Math.floor(Math.random() * (max - min + 1)) + min,
            randomItem: array => array[Math.floor(Math.random() * array.length)],
            createParticle: (className = 'firework') => {
                const particle = document.createElement('div');
                particle.className = className;
                return particle;
            },
            setStyles: (element, styles) => {
                Object.assign(element.style, styles);
            }
        };

        // çƒŸèŠ±ç±»
        class Firework {
            constructor(wish) {
                this.wish = wish;
                this.init();
            }

            init() {
                const firework = utils.createParticle();
                this.startX = utils.random(0, window.innerWidth);
                
                utils.setStyles(firework, {
                    left: `${this.startX}px`,
                    bottom: '0',
                    background: utils.randomItem(CONFIG.colors.firework)
                });
                
                document.body.appendChild(firework);
                this.rise(firework);
            }

            rise(firework) {
                let posY = 0;
                const rise = setInterval(() => {
                    posY += 5;
                    firework.style.bottom = `${posY}px`;
                    
                    if (posY > window.innerHeight * 0.5) {
                        clearInterval(rise);
                        this.explode(firework, posY);
                    }
                }, CONFIG.firework.duration.rise);
            }

            explode(firework, posY) {
                const x = this.startX;
                const y = window.innerHeight - posY;
                const type = utils.randomItem(CONFIG.firework.types);
                
                firework.remove();
                this.createNeonText(x, y);
                this.createExplosion(x, y, type);
            }

            createNeonText(x, y) {
                const showUserWish = Math.random() < CONFIG.text.showWishProbability; // 30%æ¦‚ç‡æ˜¾ç¤ºç”¨æˆ·æ„¿æœ›
                const text = document.createElement('div');
                text.className = 'neon-text';
                
                if (showUserWish) {
                    text.textContent = this.wish;
                } else {
                    text.textContent = utils.randomItem(CONFIG.text.wishes);
                }

                const color = utils.randomItem(CONFIG.colors.firework);
                
                const fontSize = utils.random(80, 120); // ä¿®æ”¹ä¸ºæ›´å¤§çš„å­—ä½“èŒƒå›´ï¼š80px åˆ° 120px
                
                text.style.cssText = `
                    left: ${x}px;
                    top: ${y}px;
                    color: ${color};
                    transform: translate(-50%, -50%);
                    opacity: 1;
                    font-size: ${fontSize}px;
                    font-family: HarmonyOS Sans SC, sans-serif; // æ·»åŠ é¸¿è’™å­—ä½“
                `;
                
                document.body.appendChild(text);

                const rotation = utils.random(-15, 15); // -15åº¦åˆ°15åº¦ä¹‹é—´çš„éšæœºæ—‹è½¬
                text.style.transform += ` rotate(${rotation}deg)`;

                requestAnimationFrame(() => {
                    setTimeout(() => {
                        text.style.opacity = '0';
                        text.style.transform += ' scale(1.2)'; // æ·»åŠ ç¼©æ”¾æ•ˆæœ
                        setTimeout(() => text.remove(), CONFIG.animation.textDuration);
                    }, CONFIG.animation.textDuration - 800);
                });
            }

            createExplosion(x, y, type) {
                const count = CONFIG.firework.particleCounts[type] || CONFIG.firework.particleCounts.circle;
                const duration = CONFIG.firework.duration.explosion;

                for (let i = 0; i < count; i++) {
                    const particle = utils.createParticle();
                    const color = utils.randomItem(CONFIG.colors.firework);
                    // éšæœºç²’å­å¤§å°
                    const size = utils.random(CONFIG.firework.size.min, CONFIG.firework.size.max); // å¢åŠ ç²’å­å¤§å°èŒƒå›´
                    
                    particle.style.cssText = `
                        width: ${size}px;
                        height: ${size}px;
                        background: ${color};
                        box-shadow: 0 0 ${size * 2}px ${color},
                                   0 0 ${size * 4}px ${color};
                        left: ${x}px;
                        top: ${y}px;
                    `;

                    const angle = (i / count) * Math.PI * 2;
                    const velocity = utils.random(2, 8);
                    let particleX, particleY;

                    switch (type) {
                        case 'heart':
                            particleX = 16 * Math.pow(Math.sin(angle), 3) * CONFIG.firework.spread.heart; // å¢åŠ æ‰©æ•£èŒƒå›´
                            particleY = -(13 * Math.cos(angle) - 5 * Math.cos(2 * angle) - 2 * Math.cos(3 * angle) - Math.cos(4 * angle)) * CONFIG.firework.spread.heart;
                            break;
                        case 'spiral':
                            particleX = Math.cos(angle * CONFIG.firework.spread.spiral) * (i * CONFIG.firework.spread.spiral); // å¢åŠ èºæ—‹å¤§å°
                            particleY = Math.sin(angle * CONFIG.firework.spread.spiral) * (i * CONFIG.firework.spread.spiral);
                            break;
                        case 'burst':
                            particleX = Math.cos(angle) * velocity * CONFIG.firework.spread.burst; // å¢åŠ çˆ†è£‚èŒƒå›´
                            particleY = Math.sin(angle) * velocity * CONFIG.firework.spread.burst;
                            break;
                        default: // circle
                            particleX = Math.cos(angle) * CONFIG.firework.spread.circle; // å¢åŠ åœ†å½¢åŠå¾„
                            particleY = Math.sin(angle) * CONFIG.firework.spread.circle;
                    }

                    document.body.appendChild(particle);
                    
                    particle.animate([
                        { 
                            transform: 'translate(0, 0) scale(1)', 
                            opacity: 1 
                        },
                        { 
                            transform: `translate(${particleX}px, ${particleY}px) scale(0.5)`, 
                            opacity: 0 
                        }
                    ], {
                        duration: duration,
                        easing: 'cubic-bezier(0.4, 0, 0.2, 1)'
                    }).onfinish = () => particle.remove();
                }
            }
        }

        // åˆå§‹åŒ–å‡½æ•°
        function init() {
            createStars();
            createMoon();
            initClouds(); // æ·»åŠ äº‘æœµåˆå§‹åŒ–
            setInterval(createLantern, CONFIG.animation.lanternInterval);
        }

        // å¯åŠ¨å‡½æ•°
        function launchFireworks() {
            const wishInput = document.getElementById('wish');
            const wish = wishInput.value.trim();
            
            if (!wish) {
                alert('è¯·å…ˆå†™ä¸‹ä½ çš„æ„¿æœ›!');
                return;
            }

            // ç§»é™¤æ¨¡ç³Šæ•ˆæœ
            document.getElementById('blurOverlay').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('blurOverlay').style.display = 'none';
            }, 1000);

            // è‡ªåŠ¨æ’­æ”¾èƒŒæ™¯éŸ³ä¹
            bgMusic.play();
            isPlaying = true;

            document.getElementById('wishDisplay').textContent = `âœ¨ ${wish} âœ¨`;
            document.getElementById('wishDisplay').style.opacity = '1';
            document.querySelector('.wish-container').style.display = 'none';

            setInterval(() => new Firework(wish), CONFIG.animation.fireworkInterval);
        }

        // åˆ›å»ºæ˜Ÿæ˜Ÿ
        function createStars() {
            const starCount = 50;
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * window.innerWidth + 'px';
                star.style.top = Math.random() * window.innerHeight + 'px';
                document.body.appendChild(star);
            }
        }

        // åˆ›å»ºæœˆäº®
        function createMoon() {
            const moon = document.createElement('div');
            moon.className = 'moon';
            document.body.appendChild(moon);
        }

        // åˆ›å»ºç¯ç¬¼
        function createLantern() {
            const lantern = document.createElement('div');
            lantern.className = 'lantern';
            
            // éšæœºé€‰æ‹©æ–‡å­—
            const text = utils.randomItem(CONFIG.text.lantern);
            lantern.setAttribute('data-text', text);
            
            // æ·»åŠ è£…é¥°çº¿æ¡
            for (let i = 0; i < 3; i++) {
                const decoration = document.createElement('div');
                decoration.className = 'decoration';
                lantern.appendChild(decoration);
            }
            
            // æ·»åŠ ç«ç„°
            const flame = document.createElement('div');
            flame.className = 'flame';
            lantern.appendChild(flame);
            
            // éšæœºä½ç½®
            lantern.style.left = Math.random() * window.innerWidth + 'px';
            lantern.style.bottom = '0px';
            
            document.body.appendChild(lantern);

            // é£è¡ŒåŠ¨ç”»
            let posY = 0;
            const fly = setInterval(() => {
                posY += 2;
                lantern.style.bottom = posY + 'px';

                if (posY > window.innerHeight) {
                    clearInterval(fly);
                    lantern.remove();
                }
            }, 50);
        }

        // åˆ›å»ºäº‘æœµå‡½æ•°
        function createCloud() {
            const cloud = document.createElement('div');
            cloud.className = 'cloud';
            
            // éšæœºå¤§å°
            const size = utils.random(CONFIG.cloud.sizes.min, CONFIG.cloud.sizes.max);
            
            // éšæœºé«˜åº¦
            const top = utils.random(CONFIG.cloud.heights.min, CONFIG.cloud.heights.max);
            
            // éšæœºé€Ÿåº¦
            const duration = utils.random(CONFIG.cloud.speeds.min, CONFIG.cloud.speeds.max);
            
            utils.setStyles(cloud, {
                width: `${size}px`,
                height: `${size * 0.6}px`,
                top: `${top}%`,
                left: '-100px',
                animationDuration: `${duration}s`
            });
            
            document.body.appendChild(cloud);
            
            // äº‘æœµé£˜è¿‡åç§»é™¤
            cloud.addEventListener('animationend', () => cloud.remove());
        }

        // åˆå§‹åŒ–äº‘æœµ
        function initClouds() {
            // åˆå§‹åˆ›å»ºå‡ æœµäº‘
            for(let i = 0; i < CONFIG.cloud.count; i++) {
                setTimeout(() => {
                    createCloud();
                }, i * (CONFIG.cloud.interval / CONFIG.cloud.count));
            }
            
            // å®šæœŸåˆ›å»ºæ–°äº‘
            setInterval(createCloud, CONFIG.cloud.interval);
        }

        // æ˜¾ç¤ºæ„¿æœ›å¯¹è¯æ¡†
        function showWishDialog() {
            document.getElementById('wishDialog').classList.add('show');
            document.getElementById('overlay').classList.add('show');
        }

        // æäº¤æ„¿æœ›
        function submitWish() {
            const wish = document.getElementById('wishInput').value;
            if (wish.trim()) {
                document.getElementById('wishDialog').classList.remove('show');
                document.getElementById('overlay').classList.remove('show');
                
                // ç§»é™¤æ¨¡ç³Šæ•ˆæœ
                document.getElementById('blurOverlay').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('blurOverlay').style.display = 'none';
                }, 1000);

                // è‡ªåŠ¨æ’­æ”¾èƒŒæ™¯éŸ³ä¹
                bgMusic.play();
                isPlaying = true;

                launchFireworks(wish);
            }
        }

        // éŸ³ä¹æ§åˆ¶
        let isPlaying = false;
        const bgMusic = new Audio('è½ä¸‹.mp3'); // éœ€è¦æ·»åŠ èƒŒæ™¯éŸ³ä¹æ–‡ä»¶
        bgMusic.loop = true;

        function toggleMusic() {
            if (isPlaying) {
                bgMusic.pause();
                isPlaying = false;
            } else {
                bgMusic.play();
                isPlaying = true;
            }
        }

        // æ˜¾ç¤ºè®¾ç½®
        function showSettings() {
            document.getElementById('settingsDialog').classList.add('show');
            document.getElementById('overlay').classList.add('show');
        }

        // ä¿å­˜è®¾ç½®
        function saveSettings() {
            const speed = document.getElementById('fireworkSpeed').value;
            const density = document.getElementById('fireworkDensity').value;
            
            // æ›´æ–°çƒŸèŠ±é…ç½®
            CONFIG.animation.fireworkInterval = 1000 - (speed * 100);
            CONFIG.firework.particleCounts = {
                heart: 40 * (density / 5),
                spiral: 50 * (density / 5),
                burst: 30 * (density / 5),
                circle: 30 * (density / 5),
                double: 60 * (density / 5)
            };

            document.getElementById('settingsDialog').classList.remove('show');
            document.getElementById('overlay').classList.remove('show');
        }

        // ç‚¹å‡»é®ç½©å±‚å…³é—­å¯¹è¯æ¡†
        document.getElementById('overlay').addEventListener('click', () => {
            document.querySelectorAll('.dialog').forEach(dialog => {
                dialog.classList.remove('show');
            });
            document.getElementById('overlay').classList.remove('show');
            document.getElementById('overlay').classList.remove('sidebar-overlay');
            document.getElementById('sidebar').classList.remove('show');
        });

        // ä¾§è¾¹æ æ§åˆ¶
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            
            sidebar.classList.toggle('show');
            overlay.classList.toggle('show');
            overlay.classList.toggle('sidebar-overlay');
        }

        // å…³äºå¯¹è¯æ¡†
        function showAbout() {
            const dialog = document.createElement('div');
            dialog.className = 'dialog';
            dialog.style.zIndex = '1000'; // æ·»åŠ è¾ƒé«˜çš„ z-index å€¼
            dialog.innerHTML = `
                <h2>å…³äºæ–°å¹´çƒŸèŠ± ğŸ†</h2>
                <p>è¿™æ˜¯ä¸€ä¸ªå……æ»¡æ–°å¹´æ°”æ¯çš„äº’åŠ¨çƒŸèŠ±é¡µé¢ï¼Œåœ¨è¿™é‡Œä½ å¯ä»¥ï¼š</p>
                <ul>
                    <li>âœ¨ å‘é€æ–°å¹´æ„¿æœ›</li>
                    <li>ğŸ† è§‚èµç»šä¸½çƒŸèŠ±</li>
                    <li>ğŸµ è†å¬æ–°å¹´éŸ³ä¹</li>
                    <li>âš™ï¸ è‡ªå®šä¹‰çƒŸèŠ±æ•ˆæœ</li>
                </ul>
                <div class="author-info" style="margin-top: 20px;">
                    <p>ğŸŒŸ ä½œè€…ï¼šMoniwarmth</p>
                    <p>ğŸ¤– ç”± Cursor å¼ºåŠ›é©±åŠ¨</p>
                </div>
                <button class="md-button" onclick="this.parentElement.classList.remove('show')">å…³é—­</button>
            `;
            
            document.body.appendChild(dialog);
            setTimeout(() => dialog.classList.add('show'), 10);
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.addEventListener('load', init);
    </script>
</body>
</html>

