<!DOCTYPE html>
<html>
<head>
    <title>新年祝福抽签</title>
    <style>
        body {
            margin: 0;
            height: 100vh;
            background: linear-gradient(to bottom, #0f0c29, #302b63, #24243e);
            font-family: "Microsoft YaHei", sans-serif;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 10;
            width: auto;
            height: auto;
        }
        .sky-lantern::after {
            content: '福';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #ffd700;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(255, 215, 0, 0.8);
        }

        .sky-lantern .decoration {
            position: absolute;
            width: 40px;
            height: 10px;
            background: linear-gradient(90deg, #ffd700, #ffeb3b);
            border-radius: 5px;
            left: 50%;
            transform: translateX(-50%);
        }

        .sky-lantern .decoration:nth-child(1) {
            top: 15px;
        }

        .sky-lantern .decoration:nth-child(2) {
            top: 35px;
        }

        .sky-lantern .decoration:nth-child(3) {
            top: 55px;
        }

        .sky-lantern {
            position: absolute;
            width: 60px;
            height: 90px;
            background: linear-gradient(to bottom, #ff4d4d, #ff6b6b);
            border-radius: 30px 30px 5px 5px;
            box-shadow: 0 0 30px rgba(255, 77, 77, 0.6);
            animation: float 8s infinite ease-in-out;
            z-index: 0;
            left: var(--x, 50%);
            top: var(--y, 50%);
            animation-delay: var(--delay, 0s);
            transition: transform 0.3s ease;
        }

        .sky-lantern::before {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 20px;
            background: rgba(255, 165, 0, 0.8);
            border-radius: 50%;
            box-shadow: 0 0 15px rgba(255, 165, 0, 0.6);
            animation: flicker 2s infinite;
        }

        .sky-lantern:hover {
            transform: scale(1.1);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(3deg); }
            50% { transform: translateY(-30px) rotate(-3deg); }
        }

        @keyframes flicker {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .blessing-box {
            width: 300px;
            height: 400px;
            background: rgba(255, 215, 0, 0.1);
            border: 2px solid #ffd700;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.2);
            backdrop-filter: blur(5px);
            margin: 0 auto;
            position: relative;
            z-index: 10;
        }

        .blessing-text {
            background: linear-gradient(45deg, #ff3333, #ffffff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-size: 48px;
            margin: 20px;
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-shadow: 2px 2px 4px rgba(255, 51, 51, 0.3);
            font-weight: bold;
            line-height: 1.2;
            text-align: center;
        }

        .blessing-title {
            font-size: 36px;
            background: linear-gradient(45deg, #ffd700, #ff3333);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 3px 3px 6px rgba(255, 215, 0, 0.5);
            margin-bottom: 30px !important;
        }

        .draw-button {
            background: #ff4d4d;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .draw-button:hover {
            transform: scale(1.1);
            background: #ff6b6b;
        }

        .lantern {
            position: absolute;
            width: 50px;
            height: 70px;
            background: linear-gradient(to bottom, #ff4d4d, #ff6b6b);
            border-radius: 25px 25px 8px 8px;
            box-shadow: 0 0 20px rgba(255, 77, 77, 0.5);
            animation: swing 3s infinite ease-in-out;
            z-index: 0;
            position: relative;
        }

        /* 添加灯笼装饰 */
        .lantern::before {
            content: '福';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #ffd700;
            font-size: 20px;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(255, 215, 0, 0.8);
        }

        /* 添加灯笼顶部 */
        .lantern::after {
            content: '';
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 10px;
            background: #ffd700;
            border-radius: 5px 5px 0 0;
        }

        /* 添加灯笼底部火焰效果 */
        .lantern .flame {
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 20px;
            background: radial-gradient(circle at center, #ffeb3b, #ffd700, transparent 70%);
            border-radius: 50%;
            animation: flicker 2s infinite ease-in-out;
        }

        /* 添加装饰线条 */
        .lantern .decoration {
            position: absolute;
            width: 80%;
            height: 2px;
            background: rgba(255, 215, 0, 0.5);
            left: 10%;
        }

        .lantern .decoration:nth-child(1) { top: 20%; }
        .lantern .decoration:nth-child(2) { top: 40%; }
        .lantern .decoration:nth-child(3) { top: 60%; }

        @keyframes flicker {
            0%, 100% { 
                opacity: 1;
                transform: translateX(-50%) scale(1);
            }
            50% { 
                opacity: 0.8;
                transform: translateX(-50%) scale(0.9);
            }
        }

        .firecracker {
            position: absolute;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            pointer-events: none;
            z-index: 1;
        }

        @keyframes swing {
            0%, 100% { transform: rotate(-5deg); }
            50% { transform: rotate(5deg); }
        }

        @keyframes explode {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(20); opacity: 0; }
        }

        /* 添加新的动画效果 */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .blessing-text.animate {
            animation: fadeIn 0.5s ease-out;
        }

        /* 添加媒体查询以确保在小屏幕上也能正确显示 */
        @media screen and (max-height: 600px) {
            .blessing-box {
                height: 300px;
                transform: scale(0.9);
            }
            
            .blessing-title {
                font-size: 28px;
                margin-bottom: 15px !important;
            }
            
            .blessing-text {
                font-size: 36px;
                min-height: 100px;
            }
        }

        /* 添加星星样式 */
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 1.5s infinite ease-in-out;
            pointer-events: none;
            z-index: 1;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        /* 添加 emoji 降落动画样式 */
        .falling-emoji {
            position: absolute;
            font-size: 24px;
            pointer-events: none;
            animation: fallDown 3s linear forwards;
            z-index: 1;
        }

        @keyframes fallDown {
            0% {
                transform: translateY(-20px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* 添加蛇形动画效果 */
        .emoji-firework-particle {
            position: absolute;
            pointer-events: none;
            animation: snakeFirework 2s ease-out forwards;
            font-size: 12px;
            z-index: 1;
        }

        @keyframes snakeFirework {
            0% {
                transform: translate(0, 0) scale(0.1);
                opacity: 1;
            }
            50% {
                transform: translate(var(--tx), var(--ty)) scale(1) rotate(var(--rotation));
                opacity: 1;
            }
            100% {
                transform: translate(var(--tx), var(--ty)) scale(1) rotate(var(--rotation));
                opacity: 0;
            }
        }

        /* 在 CSS 部分添加新的动画 */
        @keyframes flyAway {
            0% {
                transform: translate(0, 0) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translate(var(--fly-x), -100vh) rotate(var(--fly-rotation));
                opacity: 0;
            }
        }

        .lantern.fly-away {
            animation: flyAway 2s ease-out forwards;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="blessing-box">
            <h2 class="blessing-title">新年快乐！<br>来抽个签吧！</h2>
            <div class="blessing-text" id="blessingText">点击下方按钮抽取祝福</div>
            <button class="draw-button" onclick="drawBlessing()">抽取祝福</button>
        </div>
    </div>

    <script>
        const blessings = [
            "金蛇献瑞，万事如意",
            "蛇舞灵动，事业腾飞",
            "蛇年大吉，阖家欢乐",
            "财源广进，福寿安康",
            "蛇年纳福，前程似锦",
            "吉祥如意，心想事成",
            "蛇年祥瑞，幸福安康",
            "蛇舞盛世，万事顺遂",
            "新年快乐，大吉大利",
            "福星高照，喜气洋洋",
            "蛇年纳福，百事亨通",
            "五福临门，万事胜意"
        ];

        const fireworkColors = [
            '#ff0000', '#ffd700', '#00ff00', '#0000ff', 
            '#ff00ff', '#00ffff', '#ff8c00', '#ff1493',
            '#9400d3', '#7fff00', '#ff69b4', '#00fa9a'
        ];

        // 修改祝福语和对应的 emoji 映射
        const blessingEmojis = {
            "金蛇献瑞，万事如意": ["🐍", "✨"],
            "蛇舞灵动，事业腾飞": ["🐍", "💫"],
            "蛇年大吉，阖家欢乐": ["🐍", "🏮"],
            "财源广进，福寿安康": ["💰", "🧧"],
            "蛇年纳福，前程似锦": ["🐍", "🌟"],
            "吉祥如意，心想事成": ["🎊", "💫"],
            "蛇年祥瑞，幸福安康": ["🐍", "🎋"],
            "蛇舞盛世，万事顺遂": ["🐍", "🌟"],
            "新年快乐，大吉大利": ["🎆", "🎈"],
            "福星高照，喜气洋洋": ["⭐", "🎉"],
            "蛇年纳福，百事亨通": ["🐍", "🧧"],
            "五福临门，万事胜意": ["🏮", "💝"]
        };

        // 修改 JavaScript 部分的 createLanterns 函数
        function createLanterns() {
            const sections = 6;
            const sectionWidth = window.innerWidth / sections;
            const lanternWidth = 50;
            
            for (let i = 0; i < sections; i++) {
                const lantern = document.createElement('div');
                lantern.className = 'lantern';
                lantern.dataset.index = i; // 添加索引标识
                
                // 添加装饰线条
                for (let j = 0; j < 3; j++) {
                    const decoration = document.createElement('div');
                    decoration.className = 'decoration';
                    lantern.appendChild(decoration);
                }
                
                // 添加火焰效果
                const flame = document.createElement('div');
                flame.className = 'flame';
                lantern.appendChild(flame);
                
                const minX = i * sectionWidth + lanternWidth;
                const maxX = (i + 1) * sectionWidth - lanternWidth;
                const x = minX + Math.random() * (maxX - minX);
                const y = Math.random() * (window.innerHeight / 2);
                
                lantern.style.left = `${x}px`;
                lantern.style.top = `${y}px`;
                document.body.appendChild(lantern);
            }
        }

        // 优化鞭炮效果
        function createFirecracker(x, y) {
            const count = 12; // 每次创建多个粒子
            for (let i = 0; i < count; i++) {
                const angle = (i / count) * Math.PI * 2;
                const velocity = 5;
                const firecracker = document.createElement('div');
                firecracker.className = 'firecracker';
                firecracker.style.left = `${x}px`;
                firecracker.style.top = `${y}px`;
                firecracker.style.background = fireworkColors[Math.floor(Math.random() * fireworkColors.length)];
                
                // 添加径向运动
                const animation = firecracker.animate([
                    { transform: 'scale(1) translate(0, 0)', opacity: 1 },
                    { 
                        transform: `scale(2) translate(${Math.cos(angle) * 100}px, ${Math.sin(angle) * 100}px)`,
                        opacity: 0 
                    }
                ], {
                    duration: 1000,
                    easing: 'cubic-bezier(0.4, 0, 0.2, 1)'
                });

                document.body.appendChild(firecracker);
                animation.onfinish = () => document.body.removeChild(firecracker);
            }
        }

        // 修改烟花函数，添加蛇形路径
        function createEmojiFirework(x, y, emoji) {
            const particleCount = 24; // 减少粒子数量
            const radius = 150; // 增加爆炸半径

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'emoji-firework-particle';
                particle.textContent = emoji;
                
                // 创建蛇形路径
                const angle = (i / particleCount) * Math.PI * 2;
                const spiralFactor = 1 + (i / particleCount) * 0.5; // 添加螺旋效果
                const tx = Math.cos(angle) * radius * spiralFactor;
                const ty = Math.sin(angle) * radius * spiralFactor;
                const rotation = Math.random() * 360; // 随机旋转
                
                particle.style.left = `${x}px`;
                particle.style.top = `${y}px`;
                particle.style.setProperty('--tx', `${tx}px`);
                particle.style.setProperty('--ty', `${ty}px`);
                particle.style.setProperty('--rotation', `${rotation}deg`);
                
                document.body.appendChild(particle);
                
                particle.addEventListener('animationend', () => {
                    document.body.removeChild(particle);
                });
            }
        }

        // 修改抽签函数
        function drawBlessing() {
            const blessingText = document.getElementById('blessingText');
            const randomBlessing = blessings[Math.floor(Math.random() * blessings.length)];
            
            // 让随机的灯笼飞走
            const lanterns = document.querySelectorAll('.lantern:not(.fly-away)');
            if (lanterns.length > 0) {
                const randomLantern = lanterns[Math.floor(Math.random() * lanterns.length)];
                // 设置随机的飞行方向
                const flyX = (Math.random() - 0.5) * window.innerWidth;
                const rotation = (Math.random() - 0.5) * 720; // 随机旋转角度
                
                randomLantern.style.setProperty('--fly-x', `${flyX}px`);
                randomLantern.style.setProperty('--fly-rotation', `${rotation}deg`);
                randomLantern.classList.add('fly-away');
                
                // 灯笼飞走后移除元素
                randomLantern.addEventListener('animationend', () => {
                    randomLantern.remove();
                    // 创建新的灯笼
                    const sectionIndex = parseInt(randomLantern.dataset.index);
                    const sectionWidth = window.innerWidth / 6;
                    const lanternWidth = 50;
                    const minX = sectionIndex * sectionWidth + lanternWidth;
                    const maxX = (sectionIndex + 1) * sectionWidth - lanternWidth;
                    const x = minX + Math.random() * (maxX - minX);
                    const y = Math.random() * (window.innerHeight / 2);
                    
                    const newLantern = document.createElement('div');
                    newLantern.className = 'lantern';
                    newLantern.dataset.index = sectionIndex;
                    
                    // 添加装饰线条
                    for (let j = 0; j < 3; j++) {
                        const decoration = document.createElement('div');
                        decoration.className = 'decoration';
                        newLantern.appendChild(decoration);
                    }
                    
                    // 添加火焰效果
                    const flame = document.createElement('div');
                    flame.className = 'flame';
                    newLantern.appendChild(flame);
                    
                    newLantern.style.left = `${x}px`;
                    newLantern.style.top = `${y}px`;
                    document.body.appendChild(newLantern);
                });
            }
            
            blessingText.classList.remove('animate');
            void blessingText.offsetWidth;
            blessingText.classList.add('animate');
            blessingText.textContent = randomBlessing;

            // 创建对应的 emoji 降落效果
            const emojis = blessingEmojis[randomBlessing];
            if (emojis) {
                // 创建多个 emoji 实例
                for (let i = 0; i < 10; i++) {
                    setTimeout(() => {
                        const randomEmoji = emojis[Math.floor(Math.random() * emojis.length)];
                        createEmojiFirework(
                            Math.random() * window.innerWidth,
                            Math.random() * window.innerHeight,
                            randomEmoji
                        );
                    }, i * 300); // 每300ms创建一个新的emoji
                }
            }

            // 原有的鞭炮效果
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    createFirecracker(
                        window.innerWidth / 2 + (Math.random() - 0.5) * 200,
                        window.innerHeight / 2 + (Math.random() - 0.5) * 200
                    );
                }, i * 200);
            }
        }

        // 使用 requestAnimationFrame 优化性能
        let lastFireworkTime = 0;
        function animateFireworks(timestamp) {
            if (timestamp - lastFireworkTime > 500) {
                createFirecracker(
                    Math.random() * window.innerWidth,
                    Math.random() * window.innerHeight
                );
                lastFireworkTime = timestamp;
            }
            requestAnimationFrame(animateFireworks);
        }

        // 添加创建星星的函数
        function createStars() {
            const numberOfStars = 20; // 控制星星数量
            
            for (let i = 0; i < numberOfStars; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                
                // 随机位置
                const x = Math.random() * window.innerWidth;
                const y = Math.random() * window.innerHeight;
                
                // 随机大小 (1-3像素)
                const size = 1 + Math.random() * 2;
                
                star.style.left = `${x}px`;
                star.style.top = `${y}px`;
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                
                // 随机动画延迟
                star.style.animationDelay = `${Math.random() * 2}s`;
                
                document.body.appendChild(star);
            }
        }

        // 初始化
        window.addEventListener('load', () => {
            createLanterns();
            createStars();
            requestAnimationFrame(animateFireworks);
        });
    </script>
</body>
</html>
